<button mat-stroked-button (click)="goToHome()" >Return Home</button>

<div class="spacer">
<app-add-recipe></app-add-recipe>

<div>

  <ul *ngFor=" let recipe of recipes$ | async">
    <div class="mat-card">
      <div *ngIf="!editState">
    <div class="mat-card-title">
      {{recipe.name}}
    </div>
      <mat-icon class="v-align-right" *ngIf="!editState" (click)="editItem($event, recipe)" style="flex: 1;">edit</mat-icon>
      </div>
      <div *ngIf="editState">
        <mat-icon *ngIf="editState" (click)="clearState()" class="v-align-right">keyboard_arrow_up</mat-icon>
        <div *ngIf="recipeToEdit.id === recipe.id">

          <form [formGroup]="updateRecipe" (ngSubmit)="submitHandler()">
            <hr>
            <label>Name</label><br>
            <mat-form-field>
              <input type="text" matInput placeholder="{{recipe.name}}" formControlName="name">
            </mat-form-field><br>
            <label>Estimated Time</label><br>
            <mat-form-field>
              <input type="number" matInput placeholder="{{recipe.estimatedTime}}" formControlName="estimatedTime">
            </mat-form-field><br>
            <label>Ingredients</label>

            <div *ngFor="let ing of recipe.ingredients">
              <label>Name</label>
              <mat-form-field>
                <input type="text" matInput placeholder="{{ing.name}}" formControlName="ingName">
              </mat-form-field>

              <label>Amount</label>
              <mat-form-field>
                <input type="text" matInput placeholder="{{ing.amount}}" formControlName="ingAmount">
              </mat-form-field>
            </div>

            <div formArrayName="ingredients" *ngFor="let ing of ingredients.controls; let i=index" [formGroupName]="i">
                <div formGroupName="i">
                <mat-form-field>
                  <input type="text" matInput placeholder="Name" formControlName="ingName">
                </mat-form-field>

                <mat-form-field class="spacerIng">
                  <input type="number" matInput placeholder="Amount In Grams" formControlName="ingAmount">
                </mat-form-field>

                <button mat-raised-button color="warn" (click)="deleteIngredient(i)">Delete</button>

              </div>
              </div>
            <button mat-raised-button color="primary" (click)="addIngToForm()">Add Ingredient</button>
            <button mat-raised-button color="warn" (click)="deleteRecipe(recipe)">Delete Recipe</button>
            <button mat-raised-button color="accent" (click)="submitHandler()">Update Recipe</button>
          </form>
        </div>


      </div>
    </div>
  </ul>

</div>

</div>
